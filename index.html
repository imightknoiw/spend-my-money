<!DOCTYPE html>
<html lang="en-US">

<head>
	<title>Spend my money!</title>
	<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ’°</text></svg>">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.1/jquery.min.js" integrity="sha512-aVKKRRi/Q/YV+4mjoKBsE4x3H+BkegoM/em46NNlCqNTmUYADjBbeNefNxYV7giUp0VxICtqdrbqU7iVaeZNXA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
	<meta name="title" content="ðŸ’° Spend my money!">
	<meta name="description" content="\"Spend my money\" in this addicting money-spending simulator game! Buy your dream items like Airpod Pros, Lamborghinis, you name it!">
	<meta property="og:type" content="website">
	<meta property="og:url" content="https://imightknoiw.github.io/spend-my-money/">
	<meta property="og:title" content="ðŸ’° Spend my money!">
	<meta property="og:description" content="\"Spend my money\" in this addicting money-spending simulator game! Buy your dream items like Airpod Pros, Lamborghinis, you name it!">
	<meta property="og:image" content="">
	<meta property="twitter:card" content="summary_large_image">
	<meta property="twitter:url" content="https://imightknoiw.github.io/spend-my-money/">
	<meta property="twitter:title" content="ðŸ’° Spend my money!">
	<meta property="twitter:description" content="\"Spend my money\" in this addicting money-spending simulator game! Buy your dream items like Airpod Pros, Lamborghinis, you name it!">
	<meta property="twitter:image" content="">
        <style>
		.red {
		  color: red;
		}
		body {
		  -webkit-touch-callout: none; 
    		  -webkit-user-select: none; 
                  -khtml-user-select: none; 
                  -moz-user-select: none; 
                  -ms-user-select: none; 
                  user-select: none; 
		  min-height: 100vh;
       		  display: flex;
    		  flex-direction: column;
		}
		
		button {
		  cursor: pointer;
		  outline: none;
	          border: none;
	          border-radius: 10%;
		  background-color: rgba(0, 0, 0, 0.15);
		  width: 75px;
		  height: 75px;	
		  transition: background-color 0.5s	
		}
		
		button:hover {
		  background-color: rgba(0, 0, 0, 0.45);
		  transition: background-color 1s;
		}
		
		footer {
		  margin-top: auto;
		}
		
		.item {
		  height: auto;
		  width: 200px;
		  margin-bottom: 10px;	
		  margin-left: auto;
		  margin-right: auto;	
		  border: 1px solid black;
		  border-radius: 10%;
		}
	</style>	
</head>

<body style="margin:0;font-family:Arial;text-align:center;">
	<h1>ðŸ’° Spend my money!<span id="money" style="position: fixed;right: 0;">Loading</span></h1>
	<hr style="position:fixed;" />
	<div class="item">
		<label>Loading</label><br />
		<button onclick="sub(this)" value="100">Loading</button>
	</div>
	<div class="item">
		<label>Loading</label><br />
		<button onclick="sub(this)" value="500">Loading</button>
	</div>
	<div class="item">
		<label>Loading</label><br />
		<button onclick="sub(this)" value="1000">Loading</button>
	</div>
	<footer style="bottom:0;position: relative;">Last updated: <span id="lastUpdated">Loading</span></footer>
	<script>
const StarterMoney = 1669;
var CurrentMoney = StarterMoney;
var money = document.getElementById('money');
var lastUpdated = document.getElementById('lastUpdated');
let purchases = {};

function timeSince(date) {
	
	var seconds = Math.floor((new Date() - date) / 1000);
	var interval = seconds / 31536000;
	if (interval > 1) {
		return Math.floor(interval) + " years";
	}
	interval = seconds / 2592000;
	if (interval > 1) {
		return Math.floor(interval) + " months";
	}
	interval = seconds / 86400;
	if (interval > 1) {
		return Math.floor(interval) + " days";
	}
	interval = seconds / 3600;
	if (interval > 1) {
		return Math.floor(interval) + " hours";
	}
	interval = seconds / 60;
	if (interval > 1) {
		return Math.floor(interval) + " minutes";
	}
	return Math.floor(seconds) + " seconds";
}
const formatDate = (dateString) => {
	const options = {
		year: "numeric",
		month: "long",
		day: "numeric"
	};
	var date = new Date(dateString),
	   formattedDate = date.toLocaleDateString(undefined, options),
           ts = timeSince(date);       
        return `${formattedDate} (${ts} ago)`;
};

window.onload = function() {
	money.innerText = "$" + CurrentMoney;
	var buttons = document.getElementsByTagName('button');
	for (var i = 0; i < buttons.length; i++) {
		buttons[i].id = 'item' + (i + 1).toString();
    		purchases['item'+(i + 1).toString()] = 0;
   		buttons[i].innerText = "buy for $" + buttons[i].value + " ("+purchases[buttons[i].id]+"x)";
	}
	var items = document.getElementsByClassName('item');
	for (var i = 0; i < items.length; i++) {
		var labels = items[i].children[0];
		labels.innerText = 'Item ' + (i + 1).toString();
		labels.addAttribute('for', 'item' + (i + 1).toString());
	}
	$.get('https://api.github.com/repos/imightknoiw/spend-my-money/branches/main', function(response) {
                lastUpdated.innerText = formatDate(response.commit.commit.author.date);
	});
};
window.onbeforeunload = function() {
	if (StarterMoney > CurrentMoney) {
		return "NO";
	}
};

function sub(e) {
	var a = e.value;
	if (a > CurrentMoney) {
		money.classList.add('animate__animated', 'animate__shakeX', 'red');
		setTimeout(function() {
			money.classList.remove('red');
			money.classList.remove('animate__animated', 'animate__shakeX');
		}, 2100);
	} else {
		var NewAmount = (CurrentMoney - a);
		CurrentMoney = NewAmount;
		money.innerText = "$" + CurrentMoney;
		purchases[e.id] = purchases[e.id] + 1;
		e.innerText = "buy for $" + a + " ("+purchases[e.id]+"x)";
		var subFloat = document.createElement('span');
		subFloat.style.zIndex = "9999";
		subFloat.style.right = "0";
		subFloat.style.position = "fixed";
		subFloat.innerText = "-$"+a.toString();
		subFloat.classList.add('animate__animated', 'animate__fadeOutUp', 'red');
		money.appendChild(subFloat);
		setTimeout(function(){
		  subFloat.remove();
		}, 2000);
	}
}
	</script>
</body>

</html>
