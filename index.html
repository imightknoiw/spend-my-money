<!DOCTYPE html>
<html lang="en-US">

<head>
	<title>Spend my money!</title>
	<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ’°</text></svg>">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
	<style>
		.red {
		  color: red;
		}
		body {
		  -webkit-touch-callout: none; 
    		  -webkit-user-select: none; 
                  -khtml-user-select: none; 
                  -moz-user-select: none; 
                  -ms-user-select: none; 
                  user-select: none; 
		}
		button {
		  cursor: pointer;
		  outline: none;
	          border: none;
	          border-radius: 10%;
		  background-color: #D9D9D9;
		  width: 75px;
		  height: auto;	
		}
	</style>	
</head>

<body style="margin:0;font-family:Arial;text-align:center;">
	<img src="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ’°</text></svg>"></img><h1>Spend my money!<span class="animate__animated" id="money" style="position: fixed;right: 0;"></span></h1>
	<div id="item">
		<label>Item 1</label><br />
		<button onclick="sub(this.value)" value="500">Buy</button>
	</div>
	<footer style="position: fixed;bottom:0;">Last updated: <span id="lastUpdated"></span></footer>
	<script>
		const CurrentMoney = 6969;
		var money = document.getElementById('money');
		var lastUpdated = document.getElementById('lastUpdated');
		const formatDate = (dateString) => {
  			const options = { year: "numeric", 
					 month: "long", 
					 day: "numeric" 
					}
  			return new Date(dateString).toLocaleDateString(undefined, options)
		}
		window.onload = function() {
			money.innerText = "$"+CurrentMoney;
			var xhttp = new XMLHttpRequest();
			xhttp.responseType = 'json';
  			xhttp.onreadystatechange = function() {
    				if (this.readyState == 4 && this.status == 200) {
				        var data = JSON.parse(data);
      					lastUpdated.innerText = formateDate(data.response.committer.date);
    				}
  			};
  			xhttp.open("GET", "https://api.github.com/repos/imightknoiw/mysite/branches/main", true);
  			xhttp.send();
		}
		window.onbeforeunload = function() {
			return "NO";
		}
		
		function sub(a) {
			if (a > CurrentMoney){
  			  money.classList.toggle("red");
		          money.classList.toggle("animate__bounce");		
			  setTimeout(function(){
				money.classList.toggle("red");
		                money.classList.toggle("animate__bounce");
		          }, 2001);
			}else{
			  var NewAmount = (parseInt(money.innerText.toString().replace('$', '')) - a);
			  CurrentMoney = NewAmount;	
			  money.innerText = "$"+CurrentMoney;
			}
		}
	</script>
</body>

</html>
